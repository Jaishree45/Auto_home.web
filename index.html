<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Home Automation Panel</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <style>
    :root { color-scheme: dark; }
    body { font-family: 'Inter', sans-serif; }
    .value-glow { text-shadow: 0 8px 24px rgba(255,255,255,0.25); }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-700 via-purple-700 to-fuchsia-700 text-white antialiased">
  <main class="max-w-5xl mx-auto p-6">
    <!-- Card -->
    <section class="bg-white/10 backdrop-blur-xl border border-white/20 rounded-2xl shadow-2xl overflow-hidden">
      <div class="p-6 sm:p-8 flex flex-col gap-6">
        <header>
          <h1 class="text-3xl font-bold">üè† Home Automation</h1>
          <p class="text-white/80 mt-1">Control your devices and see live sensor data.</p>
        </header>

        <!-- Buttons Grid -->
        <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-5">
          <!-- LED A -->
          <div class="group bg-white/5 border border-white/10 rounded-xl p-4 flex flex-col gap-3" data-id="A">
            <span class="text-sm font-semibold">LED A</span>
            <button type="button" data-role="send-button"
              class="rounded-xl h-28 flex items-center justify-center
                     bg-gradient-to-br from-fuchsia-400/90 to-rose-400/90 text-fuchsia-950
                     font-extrabold text-6xl value-glow shadow-lg transition">
              <span class="current-value">0</span>
            </button>
          </div>
          <!-- LED B -->
          <div class="group bg-white/5 border border-white/10 rounded-xl p-4 flex flex-col gap-3" data-id="B">
            <span class="text-sm font-semibold">LED B</span>
            <button type="button" data-role="send-button"
              class="rounded-xl h-28 flex items-center justify-center
                     bg-gradient-to-br from-amber-300/90 to-yellow-400/90 text-amber-900
                     font-extrabold text-6xl value-glow shadow-lg transition">
              <span class="current-value">0</span>
            </button>
          </div>
          <!-- LED C -->
          <div class="group bg-white/5 border border-white/10 rounded-xl p-4 flex flex-col gap-3" data-id="C">
            <span class="text-sm font-semibold">LED C</span>
            <button type="button" data-role="send-button"
              class="rounded-xl h-28 flex items-center justify-center
                     bg-gradient-to-br from-sky-300/90 to-cyan-400/90 text-sky-900
                     font-extrabold text-6xl value-glow shadow-lg transition">
              <span class="current-value">0</span>
            </button>
          </div>
          <!-- Fan -->
          <div class="group bg-white/5 border border-white/10 rounded-xl p-4 flex flex-col gap-3" data-id="D">
            <span class="text-sm font-semibold">Fan</span>
            <button type="button" data-role="send-button"
              class="rounded-xl h-28 flex items-center justify-center
                     bg-gradient-to-br from-emerald-300/90 to-green-400/90 text-emerald-900
                     font-extrabold text-6xl value-glow shadow-lg transition">
              <span class="current-value">0</span>
            </button>
          </div>
        </section>

        <!-- Servo Motor Slider -->
        <section class="bg-white/5 border border-white/10 rounded-xl p-4">
          <h2 class="text-lg font-semibold mb-2">Servo Motor</h2>
          <input id="servoSlider" type="range" min="0" max="180" value="90"
            class="w-full accent-pink-500">
          <p class="mt-2">Angle: <span id="servoValue" class="font-bold">90</span>¬∞</p>
        </section>

        <!-- Sensors -->
        <section class="bg-white/5 border border-white/10 rounded-xl p-4 grid grid-cols-2 gap-4">
          <div>
            <p class="text-sm text-white/70">üå° Temperature</p>
            <p id="tempVal" class="text-2xl font-bold">-- ¬∞C</p>
          </div>
          <div>
            <p class="text-sm text-white/70">üíß Humidity</p>
            <p id="humVal" class="text-2xl font-bold">-- %</p>
          </div>
        </section>
      </div>
    </section>
  </main>

  <script>
    // --- Firebase Setup (replace with your config if needed) ---
    const firebaseConfig = {
      apiKey: "AIzaSyDr3meWiL6TlZdC5x1Qw3ORpi4CGqwyDyo",
      authDomain: "esp8266test-fa10b.firebaseapp.com",
      databaseURL: "https://esp8266test-fa10b-default-rtdb.firebaseio.com",
      projectId: "esp8266test-fa10b",
      storageBucket: "esp8266test-fa10b.firebasestorage.app",
      messagingSenderId: "40474862878",
      appId: "1:40474862878:web:8a7a4a5e2e3d40059b950f",
      measurementId: "G-6NP221J4JV"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // --- State for Buttons ---
    const state = { A:0, B:0, C:0, D:0 };

    // Update Firebase when button pressed
    document.querySelectorAll('[data-role="send-button"]').forEach(btn => {
  btn.addEventListener('click', () => {
    const id = btn.closest('[data-id]').getAttribute('data-id');

    // Toggle as string
    state[id] = state[id] === 0 ? 1 : 0;
    btn.querySelector('.current-value').textContent = state[id];

    // Map buttons to Firebase paths
    const path = "sensor/ButtonState" + (
      id === 'A' ? 1 : id === 'B' ? 2 : id === 'C' ? 3 : 4
    );

    // Send with double double-quotes
    firebase.database().ref(path).set("\"" + state[id] + "\"");
  });
});



    // Servo Slider
    const servoSlider = document.getElementById('servoSlider');
    const servoValue = document.getElementById('servoValue');
    servoSlider.addEventListener('input', () => {
      servoValue.textContent = servoSlider.value;
      firebase.database().ref('sensor/servo').set(Number(servoSlider.value));
    });

    // Read Temperature & Humidity
    const tempEl = document.getElementById('tempVal');
    const humEl = document.getElementById('humVal');
    firebase.database().ref('sensor/temp/temperature').on('value', snap => {
      tempEl.textContent = snap.val() ? snap.val() + " ¬∞C" : "-- ¬∞C";
    });
    firebase.database().ref('sensor/temp/humidity').on('value', snap => {
      humEl.textContent = snap.val() ? snap.val() + " %" : "-- %";
    });
  </script>
</body>
</html>
